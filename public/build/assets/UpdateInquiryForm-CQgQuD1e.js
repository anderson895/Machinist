import{r as d,S as I,j as e,V as x}from"./app-Xobat-FU.js";import{M as _}from"./Modal-DsUhjpN5.js";import{P as U}from"./PrimaryButton-tjVAZleo.js";import{I as i}from"./InputLabel-C4fgOz4K.js";import{T as k}from"./TextAreaInput-D2xFeg7a.js";import{I as o}from"./InputError-BhERdZOb.js";import{D as O}from"./DateTimeInput-Bl6BzE69.js";import{S as f}from"./SecondaryButton-BYvZmWXL.js";import{S as j}from"./SelectInput-BYFEZPwX.js";import{F as P}from"./FileInput-CEc4c1B9.js";import{M}from"./MultiSelectInput-BuBFnG2t.js";import{D as E}from"./DangerButton-CnDB0kVu.js";import"./transition-ZmkV3jRI.js";function K({inquiry:t,userList:h}){const g=t.allowed_viewers.map(s=>{var m;return(m=s.user)==null?void 0:m.id}),[n,u]=d.useState(t.files||[]),[c,p]=d.useState(!1),[N,v]=d.useState([]),y=()=>{p(!0)},{data:a,setData:l,post:F,processing:b,errors:r}=I({id:t.id,description:t.description,delivery_time:t.delivery_time,mop:t.mop,mod:t.mod,files:[],deletedFiles:[],viewers:[]});d.useEffect(()=>{c&&(l({id:t.id,description:t.description,delivery_time:t.delivery_time,mop:t.mop,mod:t.mod,files:[],deletedFiles:[],viewers:[]}),u(t.files||[]),v(g||[]))},[c]);const w=s=>{s.preventDefault(),F("/update-inquiry",{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{p(!1),x.success("Inquiry updated!")},onError:()=>{x.error("Something went wrong. Please try again.")}})},D=s=>{l("deletedFiles",[...a.deletedFiles,s.id]),u(n.filter(m=>m.id!==s.id))},S=()=>{p(!1)},C=s=>{v(s),l("viewers",s)};return d.useEffect(()=>{a.mod!==void 0&&l("mop","")},[a.mod]),e.jsxs(e.Fragment,{children:[e.jsx(f,{onClick:y,children:"Update"}),e.jsx(_,{show:c,children:e.jsxs("form",{onSubmit:w,encType:"multipart/form-data",className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Update Inquiry"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Update your inquiry details and attachments."}),e.jsxs("div",{children:[e.jsxs("div",{className:"mt-5",children:[e.jsx(i,{htmlFor:"viewers",value:"Limit Manufacturer Viewers"}),e.jsx(M,{id:"viewers",name:"viewers",selectedOptions:N,onChange:C,options:h.map(s=>({value:s.id,label:s.name})),className:"mt-1 block w-full",isFocused:!0}),e.jsx(o,{className:"mt-2",message:r.viewers})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx(i,{htmlFor:"description",value:"Description"}),e.jsx(k,{id:"description",name:"description",className:"mt-1 block w-full",value:a.description,onChange:s=>l("description",s.target.value),required:!0,isFocused:!0,autoComplete:"description"}),e.jsx(o,{className:"mt-2",message:r.description})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx(i,{htmlFor:"delivery_time",value:"Delivery Date"}),e.jsx(O,{id:"delivery_time",name:"delivery_time",className:"mt-1 block w-full",value:a.delivery_time,onChange:s=>l("delivery_time",s.target.value),required:!0,isFocused:!0,autoComplete:"delivery_time"}),e.jsx(o,{className:"mt-2",message:r.delivery_time})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx(i,{htmlFor:"mod",value:"Mode Of Delivery"}),e.jsx(j,{id:"mod",name:"mod",value:a.mod,onChange:s=>l("mod",s.target.value),options:[{value:"",label:""},{value:"Pick Up",label:"Pick Up"},{value:"Deliver",label:"Deliver"}],required:!0}),e.jsx(o,{className:"mt-2",message:r.mod})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx(i,{htmlFor:"mop",value:"Mode Of Payment"}),e.jsx(j,{id:"mop",name:"mop",value:a.mop,onChange:s=>l("mop",s.target.value),options:a.mod?[{value:"",label:""},{value:a.mod==="Deliver"?"COD":"COP",label:a.mod==="Deliver"?"COD":"COP"},{value:"Online Payment",label:"Online Payment"}]:[{value:"",label:""}],required:!!a.mod}),e.jsx(o,{className:"mt-2",message:r.mop})]}),n.length>0&&e.jsxs("div",{className:"mt-5",children:[e.jsx(i,{value:"Attached Files"}),n.map(s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("a",{href:`/uploads/${s.file_name}`,target:"_blank",rel:"noopener noreferrer",className:"m-0 mb-1 text-sm inline-block text-blue-600 hover:underline",children:s.file_name}),e.jsx(E,{type:"button",className:"text-[10px] px-0.5 py-1 h-[10px]",onClick:()=>D(s),children:"Delete"})]},`file-${s.id}`))]}),e.jsxs("div",{className:"mt-5",children:[e.jsx(i,{htmlFor:"files",value:"Upload files"}),e.jsx(P,{id:"files",name:"files",accept:"image/png, image/jpeg, application/pdf",multiple:!0,onChange:s=>l("files",[...s.target.files])}),Object.entries(r).filter(([s])=>s.startsWith("files.")).map(([s,m])=>e.jsx(o,{className:"mt-2",message:m},s))]})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(f,{onClick:S,children:"Cancel"}),e.jsx(U,{className:"ms-3",disabled:b,children:"Save"})]})]})})]})}export{K as default};
